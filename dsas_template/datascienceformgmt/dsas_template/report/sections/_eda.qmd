# Exploratory Data Analysis

In this section, we conduct an exploratory data analysis (EDA) to answer our research sub-questions. Each sub-section addresses one question, providing visualizations and interpretations to uncover patterns in the global film industry from 1990 to 2025.

::: {.callout-important}
## Interpretation is Key!

**Creating plots is only half the work.** The most important part of EDA is **interpreting** what your visualizations reveal about the data. For every plot, we will describe the patterns, explain why they matter, and connect the findings to our project goals.
:::

```{python}
#| label: setup-eda
#| include: false

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import ast
from quarto_runtime import project_root

# Set publication-quality style for all plots
sns.set_theme(style="whitegrid", context="notebook", 
              palette="colorblind", font_scale=1.1)

# Load the cleaned dataset
processed_data_path = project_root / "data" / "processed" / "Movie_Data_1920_to_2025_cleaned.csv"
data = pd.read_csv(processed_data_path, skipinitialspace=True)

# Convert release_date to datetime objects
data['release_date'] = pd.to_datetime(data['release_date'])

# Create a 'decade' column for analysis
data['decade'] = (data['release_date'].dt.year // 10) * 10
```

## Q1: Which film genres have dominated each decade?

To understand shifting cultural tastes, we first analyze the prevalence of different film genres over time. We group movies by decade and their primary genre to identify which categories were most produced.

```{python}
#| label: fig-genre-trends
#| fig-cap: "Proportion of top 5 film genres for each decade from 1990 to 2020s"

# Calculate total movies per decade
decade_totals = data.groupby('decade').size().reset_index(name='total_count')

# Calculate count of each genre per decade
genre_counts = data.groupby(['decade', 'primary_genre']).size().reset_index(name='count')

# Merge to get total counts and calculate proportion
genre_counts = pd.merge(genre_counts, decade_totals, on='decade')
genre_counts['proportion'] = genre_counts['count'] / genre_counts['total_count']

# Get the top 5 genres per decade based on proportion
top_genres_per_decade = (
    genre_counts.groupby('decade')
    .apply(lambda x: x.nlargest(5, 'proportion'))
    .reset_index(drop=True)
)

# Create the plot
fig, ax = plt.subplots(figsize=(6.75, 4.5))

sns.barplot(data=top_genres_per_decade, x='decade', y='proportion', hue='primary_genre', ax=ax)

# Customize plot
ax.set_title("Proportion of Dominant Film Genres by Decade", 
             fontsize=16, fontweight='bold', pad=15)
ax.set_xlabel("Decade", fontsize=12)
ax.set_ylabel("Proportion of Movies Produced", fontsize=12)
ax.legend(title='Primary Genre', bbox_to_anchor=(1.05, 1), loc='upper left')
ax.grid(True, axis='y', alpha=0.3, linestyle='--')
ax.yaxis.set_major_formatter(plt.FuncFormatter(lambda y, _: '{:.0%}'.format(y)))

plt.tight_layout()
plt.show()
```

**Interpretation:**

The bar chart in @fig-genre-trends, now showing proportions, offers a more nuanced view of shifting genre dominance.

-   **Observation**: **Drama** and **Comedy** remain foundational genres, consistently representing a significant proportion of films in every decade. However, the landscape for other genres is more dynamic. The proportion of **Action** and **Thriller** films actually decreased from the 1990s to the 2000s. A key trend in the 2000s is the emergence of the **Documentary** genre as a dominant category, which was not in the top five during the 1990s. In the 2010s, Action and Thriller films see a resurgence, reclaiming a top spot.
-   **Interpretation**: The steady presence of Drama and Comedy highlights a constant audience appetite for character-driven stories and humor. The surprising rise of Documentaries in the 2000s could be attributed to lower production costs due to digital filmmaking technology and a growing audience interest in real-world stories, possibly fueled by socio-political events of the decade. The subsequent decline of documentaries from the top-5 and the resurgence of Action/Thrillers in the 2010s and beyond suggests a return to bigger-budget, spectacle-driven "event films," aligning with the global box office focus on blockbusters.

## Q2: How have movie budgets evolved over time?

Next, we examine the economic evolution of the film industry by tracking movie budgets. To mitigate the effect of extreme outliers (mega-blockbusters), we will analyze the median budget per year.

```{python}
#| label: fig-budget-evolution
#| fig-cap: "Median movie production budget from 1990 to 2025"

# Calculate median budget per year
median_budget_per_year = data.groupby(data['release_date'].dt.year)['budget'].median().reset_index()
median_budget_per_year.columns = ['year', 'median_budget']

# Create the plot
fig, ax = plt.subplots(figsize=(6.75, 3.4))

sns.lineplot(data=median_budget_per_year, x='year', y='median_budget', ax=ax, marker='o', color='purple')

# Customize plot
ax.set_title("Median Movie Budget Evolution (1990-2025)", 
             fontsize=16, fontweight='bold', pad=15)
ax.set_xlabel("Year", fontsize=12)
ax.set_ylabel("Median Budget (in USD)", fontsize=12)
ax.grid(True, alpha=0.5, linestyle='--')
ax.get_yaxis().set_major_formatter(plt.FuncFormatter(lambda x, p: f'${x/1_000_000:.0f}M'))

plt.tight_layout()
plt.show()
```

**Interpretation:**

The line chart in @fig-budget-evolution illustrates a clear and significant trend in the cost of filmmaking.

-   **Observation**: There is a steady and pronounced upward trend in the median movie budget from 1990 to the early 2020s. While there are some fluctuations year-to-year, the overall trajectory is unambiguously positive, with median budgets increasing several-fold over the period.
-   **Interpretation**: This trend confirms the hypothesis that movies have become more expensive to produce. This is likely driven by several factors, including the increased use of costly CGI and special effects, higher salaries for top-tier actors and directors, and larger marketing campaigns required for global releases. It's important to note that this analysis does not account for inflation, which would make the real increase even more significant. This finding is crucial for understanding the financial pressures on modern studios and the increasing risk associated with film production.

## Q3: Is there a correlation between a film’s budget and its IMDb rating?

A central question for any film producer is whether more money leads to a better movie. We investigate this by plotting movie budgets against their IMDb ratings. Given that budgets span several orders of magnitude, we use a logarithmic scale for the budget axis to better visualize the relationship.

```{python}
#| label: fig-budget-rating-correlation
#| fig-cap: "Scatter plot of movie budget vs. IMDb rating"

# Filter out rows with missing budget or rating for this analysis
budget_rating_data = data.dropna(subset=['budget', 'rating'])

# Create the plot
fig, ax = plt.subplots(figsize=(4.5, 3.4))

sns.regplot(data=budget_rating_data, x='budget', y='rating',
            ax=ax, scatter_kws={'alpha': 0.2, 's': 20},
            line_kws={'color': 'red', 'linewidth': 2})

# Customize plot
ax.set_xscale('log')
ax.set_title("Correlation Between Budget and IMDb Rating", 
             fontsize=16, fontweight='bold', pad=15)
ax.set_xlabel("Budget (log scale)", fontsize=12)
ax.set_ylabel("IMDb Rating", fontsize=12)
ax.grid(True, alpha=0.3, linestyle='--')

# Add correlation coefficient
correlation = budget_rating_data['budget'].corr(budget_rating_data['rating'])
ax.text(0.05, 0.95, f'Pearson Correlation: {correlation:.3f}', 
        transform=ax.transAxes, fontsize=11,
        verticalalignment='top',
        bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5))

plt.tight_layout()
plt.show()
```

**Interpretation:**

The scatter plot in @fig-budget-rating-correlation explores the relationship between financial investment and critical reception.

-   **Observation**: The plot shows a very weak, almost flat, positive correlation between a movie's budget and its IMDb rating. The Pearson correlation coefficient is close to zero. While the regression line trends slightly upwards, the data points are widely dispersed, indicating that budget is not a strong predictor of audience rating. We can see highly-rated films at all budget levels, from very low to very high.
-   **Interpretation**: This is a critical finding for the film industry. It suggests that simply spending more money on a film does not guarantee a better reception from the audience. Creativity, storytelling, and execution appear to be far more important drivers of quality than the size of the budget. While a larger budget can enable grander visuals, it cannot compensate for a weak script or poor direction. This insight challenges the blockbuster-centric model and highlights the viability of lower-budget films that focus on quality narrative.

## Q4: Are modern films longer than those from the 1990s?

Have you ever felt that movies are getting longer? This analysis investigates whether there is data to support this common perception. We plot the average movie duration per year to see if a trend emerges.

```{python}
#| label: fig-duration-evolution
#| fig-cap: "Average movie duration (in minutes) from 1990 to 2025"

# Calculate average duration per year
avg_duration_per_year = data.groupby(data['release_date'].dt.year)['duration_minutes'].mean().reset_index()
avg_duration_per_year.columns = ['year', 'avg_duration']

# Create the plot
fig, ax = plt.subplots(figsize=(6.75, 3.4))

sns.lineplot(data=avg_duration_per_year, x='year', y='avg_duration', ax=ax, marker='.', color='darkgreen')

# Customize plot
ax.set_title("Average Movie Duration Evolution (1990-2025)", 
             fontsize=16, fontweight='bold', pad=15)
ax.set_xlabel("Year", fontsize=12)
ax.set_ylabel("Average Duration (minutes)", fontsize=12)
ax.grid(True, alpha=0.5, linestyle='--')

plt.tight_layout()
plt.show()
```

**Interpretation:**

The line chart in @fig-duration-evolution examines changes in film length over the past three decades.

-   **Observation**: The plot shows a slight but noticeable upward trend in the average duration of movies. While the average length hovered around 100-105 minutes in the 1990s, it has gradually climbed to around 105-110 minutes in more recent years. The trend is not dramatic, but it is consistent.
-   **Interpretation**: This data supports the common feeling that movies are getting longer. This could be due to several factors. The rise of "event" films and cinematic universes may encourage longer, more epic storytelling. Additionally, the shift from physical media (like VHS or DVD) to streaming removes physical constraints on runtime, giving filmmakers more freedom. This change reflects an evolution in storytelling norms and audience expectations, with viewers potentially more willing to engage with longer-form content.

## Q5: Which countries have dominated global film production?

To understand the geographical landscape of the film industry, we identify the top movie-producing countries for each decade. This helps reveal the centers of film production and how their influence has evolved.

```{python}
#| label: fig-country-production
#| fig-cap: "Top 5 movie-producing countries by decade"

# The 'countries_origin' is a string representation of a list. We need to parse it.
# We'll take the first country as the primary country of origin.
def get_first_country(countries_str):
    if pd.isna(countries_str):
        return None
    try:
        countries_list = ast.literal_eval(countries_str)
        if countries_list:
            return countries_list[0]
    except (ValueError, SyntaxError):
        return None
    return None

data['primary_country'] = data['countries_origin'].apply(get_first_country)

# Get the top 5 countries per decade
top_countries_per_decade = (
    data.dropna(subset=['primary_country'])
    .groupby(['decade', 'primary_country'])
    .size()
    .reset_index(name='count')
    .groupby('decade')
    .apply(lambda x: x.nlargest(5, 'count'))
    .reset_index(drop=True)
)

# Create the plot
fig, ax = plt.subplots(figsize=(6.75, 4.5))

sns.barplot(data=top_countries_per_decade, x='decade', y='count', hue='primary_country', ax=ax, palette='viridis')

# Customize plot
ax.set_title("Top Movie-Producing Countries by Decade", 
             fontsize=16, fontweight='bold', pad=15)
ax.set_xlabel("Decade", fontsize=12)
ax.set_ylabel("Number of Movies Produced", fontsize=12)
ax.legend(title='Country', bbox_to_anchor=(1.05, 1), loc='upper left')
ax.grid(True, axis='y', alpha=0.3, linestyle='--')

plt.tight_layout()
plt.show()
```

**Interpretation:**

The bar chart in @fig-country-production provides a clear picture of global film production leadership.

-   **Observation**: The **United States** has been the undisputed leader in film production across all decades since 1990, producing significantly more films than any other country. However, other countries have a consistent presence. The **United Kingdom**, **France**, **Japan**, and **India** regularly appear as top producers.
-   **Interpretation**: This visualization confirms the long-standing dominance of Hollywood in the global film market. However, it also highlights the strength of other national film industries. The consistent output from countries like the UK, France, India (Bollywood), and Japan demonstrates that while the US leads in quantity, vibrant and productive film cultures exist worldwide. This finding underscores the geographical bias mentioned in our data section; while the US appears dominant, this dataset may underrepresent film production from non-Western regions.

## Q6: Do the highest-rated films consistently come from the same regions?

Finally, we investigate whether critical acclaim is concentrated in specific regions. We filter for "top-tier" movies (IMDb rating of 8.0 or higher) and analyze their countries of origin.

```{python}
#| label: fig-top-rated-countries
#| fig-cap: "Origin countries of top-rated movies (IMDb Rating >= 8.0)"

# Filter for top-rated movies
top_rated_movies = data[data['rating'] >= 8.0].dropna(subset=['primary_country'])

# Count top-rated movies by country
top_rated_country_counts = top_rated_movies['primary_country'].value_counts().nlargest(10).reset_index()
top_rated_country_counts.columns = ['country', 'count']

# Create the plot
fig, ax = plt.subplots(figsize=(5.6, 3.4))

sns.barplot(data=top_rated_country_counts, x='count', y='country', ax=ax, palette='plasma')

# Customize plot
ax.set_title("Top 10 Origin Countries of Highly-Rated Films (Rating ≥ 8.0)", 
             fontsize=16, fontweight='bold', pad=15)
ax.set_xlabel("Number of Top-Rated Movies", fontsize=12)
ax.set_ylabel("Country", fontsize=12)
ax.grid(True, axis='x', alpha=0.3, linestyle='--')

plt.tight_layout()
plt.show()
```

**Interpretation:**

The bar chart in @fig-top-rated-countries reveals where the most critically acclaimed films originate.

-   **Observation**: The **United States** is the dominant producer of top-rated films, far surpassing any other country. However, other countries like the **United Kingdom**, **Japan**, and **India** also contribute a significant number of highly-rated movies.
-   **Interpretation**: While the US leads in both overall production and the production of highly-rated films, this chart shows that cinematic excellence is a global phenomenon. The strong showing from countries known for their distinct cinematic traditions (e.g., Japan for anime and classic cinema, India for Bollywood) indicates that high-quality filmmaking is not confined to Hollywood. This suggests that while the Hollywood system is effective at producing popular and critically successful films, diverse voices from around the world are also creating works that resonate strongly with audiences.
